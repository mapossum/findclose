<html>
<head>
<title>My Sample</title>
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
  crossorigin="anonymous"></script> 
<script type="text/javascript"> 
jQuery(document).ready(function(){ 

            // Function to populate dropdown with unique TO_Household values
            function populateDropdown(uniqueHouseholds) {
                var dropdown = $('#household-dropdown');
                dropdown.empty();
                $.each(uniqueHouseholds, function(i, household) {
                    dropdown.append($('<option></option>').attr('value', household).text(household));
                });
            }

            // Function to find closest households based on Total_TravelTime
            function findClosestHouseholds(selectedHousehold, allFeatures) {
                // Filter features by selected household
                var filteredFeatures = allFeatures.filter(function(feature) {
                    return feature.properties.TO_Household === selectedHousehold;
                });

                // Sort filtered features by Total_TravelTime
                filteredFeatures.sort(function(a, b) {
                    return a.properties.Total_TravelTime - b.properties.Total_TravelTime;
                });

                // Get the 20 closest households
                var closestHouseholds = filteredFeatures.slice(0, 20);

                // Display closest households on webpage (you can modify this part according to your needs)
                $('#closest-households').empty();
                $.each(closestHouseholds, function(i, feature) {
                    $('#closest-households').append('<li>' + feature.properties.TO_Household + ' - Total Travel Time: ' + feature.properties.Total_TravelTime + '</li>');
                });
            }

            // Load GeoJSON data and process it
            $.getJSON('PW_Connections.geojson', function(data) {
                // Extract unique TO_Household values
                var uniqueHouseholds = [...new Set(data.features.map(feature => feature.properties.TO_Household))];
                // Populate dropdown with unique values
                populateDropdown(uniqueHouseholds);

                // Event listener for dropdown change
                $('#household-dropdown').change(function() {
                    var selectedHousehold = $(this).val();
                    // Call function to find closest households
                    findClosestHouseholds(selectedHousehold, data.features);
                });
            }).fail(function(jqxhr, textStatus, error) {
                // Error handling in case file loading fails
                var err = textStatus + ", " + error;
                console.log("Request Failed: " + err);
            });

});
</script>
</head>
<body>
    <h2>Select a household:</h2>
    <select id="household-dropdown">
        <!-- Dropdown options will be populated dynamically -->
    </select>
    
    <h2>Closest households:</h2>
    <ul id="closest-households">
        <!-- Closest households will be displayed here -->
    </ul>
</body>
</html>
